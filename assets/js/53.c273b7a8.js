(window.webpackJsonp=window.webpackJsonp||[]).push([[53],{325:function(s,a,e){"use strict";e.r(a);var n=e(10),t=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"redis的安装与基本操作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#redis的安装与基本操作"}},[s._v("#")]),s._v(" Redis的安装与基本操作")]),s._v(" "),a("h2",{attrs:{id:"什么是redis"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#什么是redis"}},[s._v("#")]),s._v(" 什么是Redis")]),s._v(" "),a("ol",[a("li",[s._v("基于键值对的NoSql数据库，支持stirng、hash、list、set、zset、bitmaps、HyperLogLog、GEO等数据结构极其算法。")]),s._v(" "),a("li",[s._v("读写性能非常好。")]),s._v(" "),a("li",[s._v("有将数据存到快照或者日志上的机制，便于数据恢复。")]),s._v(" "),a("li",[s._v("提供键过期、发布订阅、事务、流水线、lua脚本等附加功能。")])]),s._v(" "),a("h2",{attrs:{id:"redis特性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#redis特性"}},[s._v("#")]),s._v(" Redis特性")]),s._v(" "),a("ol",[a("li",[s._v("读写速度据统计可达10w/s。")]),s._v(" "),a("li",[s._v("支持列表、哈希、集合、有序集合等数据结构的操作和算法。")]),s._v(" "),a("li",[s._v("功能丰富，支持键值过期、发布订阅、lua脚本创造新的Redis命令、客户端支持流水线操作，将一系列命令传给redis，避免多次网络io。")]),s._v(" "),a("li",[s._v("简单稳定")]),s._v(" "),a("li",[s._v("支持多种语言的客户端。")]),s._v(" "),a("li",[s._v("有RDB和AOF两种持久化策略。")]),s._v(" "),a("li",[s._v("支持主从复制。")]),s._v(" "),a("li",[s._v("支持高可用和分布式。")])]),s._v(" "),a("h2",{attrs:{id:"redis支持的场景"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#redis支持的场景"}},[s._v("#")]),s._v(" Redis支持的场景")]),s._v(" "),a("ol",[a("li",[s._v("缓存")]),s._v(" "),a("li",[s._v("排行榜系统")]),s._v(" "),a("li",[s._v("计数器应用")]),s._v(" "),a("li",[s._v("社交网络点赞等功能")]),s._v(" "),a("li",[s._v("消息队列(不常用)")])]),s._v(" "),a("h2",{attrs:{id:"不建议使用redis的场景"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#不建议使用redis的场景"}},[s._v("#")]),s._v(" 不建议使用Redis的场景")]),s._v(" "),a("ol",[a("li",[s._v("几亿用户行为的数据不建议使用redis进行维护管理。")]),s._v(" "),a("li",[s._v("不经常被使用的冷数据不建议使用redis管理。")])]),s._v(" "),a("h2",{attrs:{id:"redis安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#redis安装"}},[s._v("#")]),s._v(" redis安装")]),s._v(" "),a("h4",{attrs:{id:"安装c-语言的编译环境"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装c-语言的编译环境"}},[s._v("#")]),s._v(" 安装C 语言的编译环境")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[s._v("yum install centos"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("release"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("scl scl"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("utils"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("build\nyum install "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("y devtoolset"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("toolchain\nscl enable devtoolset"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" bash\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h4",{attrs:{id:"完成之后设置gcc版本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#完成之后设置gcc版本"}},[s._v("#")]),s._v(" 完成之后设置gcc版本")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[s._v("gcc "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("version\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h4",{attrs:{id:"下载redis-6-2-1-tar-gz放-opt目录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#下载redis-6-2-1-tar-gz放-opt目录"}},[s._v("#")]),s._v(" 下载redis-6.2.1.tar.gz放/opt目录")]),s._v(" "),a("h4",{attrs:{id:"解压redis"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解压redis"}},[s._v("#")]),s._v(" 解压redis")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("tar -zxvf redis-6.2.1.tar.gz\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h4",{attrs:{id:"解压完成后进入目录-cd-redis-6-2-1"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解压完成后进入目录-cd-redis-6-2-1"}},[s._v("#")]),s._v(" 解压完成后进入目录：cd redis-6.2.1")]),s._v(" "),a("h4",{attrs:{id:"键入make"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#键入make"}},[s._v("#")]),s._v(" 键入"),a("code",[s._v("make")])]),s._v(" "),a("p",[s._v("注意：2.2.2.6.如果没有准备好C语言编译环境，make 会报错—Jemalloc/jemalloc.h：没有那个文件，可以运行"),a("code",[s._v("make distclean")]),s._v("，再次运行"),a("code",[s._v("make")]),s._v("即可解决问题")]),s._v(" "),a("h4",{attrs:{id:"运行make-install"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#运行make-install"}},[s._v("#")]),s._v(" 运行"),a("code",[s._v("make install")])]),s._v(" "),a("h4",{attrs:{id:"小结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#小结"}},[s._v("#")]),s._v(" 小结")]),s._v(" "),a("p",[s._v("自此，redis安装已经全部完成，redis会被默认安装在"),a("code",[s._v("/usr/local/bin")]),s._v("目录，所以为了方便后续各种操作，我们可以运行如下命令，创建一个redis配置目录方便后续各种实验操作")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[s._v("## 创建配置文件实验文件夹\nmkdir myredis\n进入redis解压目录\ncd "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("opt"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("redis"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6.2")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("\n复制配置文件到新文件夹\ncp redis"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conf "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("myredis"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("\n## 进入redis命令目录\ncd "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("local"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h2",{attrs:{id:"启动"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#启动"}},[s._v("#")]),s._v(" 启动")]),s._v(" "),a("h4",{attrs:{id:"前台启动"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前台启动"}},[s._v("#")]),s._v(" 前台启动")]),s._v(" "),a("p",[s._v("一旦按ctrl+c进程直接结束")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[s._v("redis"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("server "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("myredis"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("redis"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conf\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h4",{attrs:{id:"后台启动-推荐"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#后台启动-推荐"}},[s._v("#")]),s._v(" 后台启动(推荐)")]),s._v(" "),a("h6",{attrs:{id:"运行一下命令配置文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#运行一下命令配置文件"}},[s._v("#")]),s._v(" 运行一下命令配置文件")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[s._v("vim "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("myredis"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("redis"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conf\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("按"),a("code",[s._v("/daemonize")]),s._v("找到"),a("code",[s._v("daemonize")]),s._v("，将此参数设置为yes，如下图所示")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[s._v("## 启动redis\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("local"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("redis"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("server "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("myredis"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("redis"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conf\n## 检查redis是否启动\n ps "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ef"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("grep redis\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h4",{attrs:{id:"启动客户端"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#启动客户端"}},[s._v("#")]),s._v(" 启动客户端")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("local"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("redis"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("cli\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h4",{attrs:{id:"cli键入ping"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cli键入ping"}},[s._v("#")]),s._v(" cli键入"),a("code",[s._v("ping")])]),s._v(" "),a("p",[s._v("若输出PONG，则说明redis客户端已经与服务端连通。")]),s._v(" "),a("h4",{attrs:{id:"关闭服务端"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#关闭服务端"}},[s._v("#")]),s._v(" 关闭服务端")]),s._v(" "),a("ol",[a("li",[s._v("客户端运行"),a("code",[s._v("shutdown")])]),s._v(" "),a("li",[a("code",[s._v("/usr/local/bin/redis-cli -p 6379 shutdown")])])]),s._v(" "),a("h2",{attrs:{id:"redis常用操作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#redis常用操作"}},[s._v("#")]),s._v(" Redis常用操作")]),s._v(" "),a("h4",{attrs:{id:"查看所有键值"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看所有键值"}},[s._v("#")]),s._v(" 查看所有键值")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("127.0.0.1:6379> keys *\n(empty list or set)\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h4",{attrs:{id:"添加或者删除键值"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#添加或者删除键值"}},[s._v("#")]),s._v(" 添加或者删除键值")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('## 添加字符串\n127.0.0.1:6379> set hello world\nOK\n127.0.0.1:6379> set java jedis\nOK\n127.0.0.1:6379> set python redis-py\nOK\n\n## 添加一个key名为mylist的键,存储一堆元素a b c d e f g\n127.0.0.1:6379> RPUSH mylist a b c d e f g\n(integer) 7\n\n## 使用keys * ,查看我们刚刚添加的key\n127.0.0.1:6379> KEYS *\n1) "python"\n2) "java"\n3) "hello"\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])]),a("h4",{attrs:{id:"查看当前键的数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看当前键的数"}},[s._v("#")]),s._v(" 查看当前键的数")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("127.0.0.1:6379> DBSIZE\n(integer) 3\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h4",{attrs:{id:"查看key是否存在"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看key是否存在"}},[s._v("#")]),s._v(" 查看key是否存在")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("## 存在返回1 不存在返回0\n127.0.0.1:6379> EXISTS java\n(integer) 1\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h4",{attrs:{id:"设置键过期"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#设置键过期"}},[s._v("#")]),s._v(" 设置键过期")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("## 添加一个键hello 设置10秒过期\n127.0.0.1:6379> set hello world\nOK\n## 查看是否存在\n127.0.0.1:6379> EXPIRE hello 10\n(integer) 1\n## 我们也可以用tts判断是否存在,若过期则返回-2\n127.0.0.1:6379> ttl  hello\n(integer) -2\n\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("h4",{attrs:{id:"查看键值对的数据类型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看键值对的数据类型"}},[s._v("#")]),s._v(" 查看键值对的数据类型")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("127.0.0.1:6379> type mylist\nlist\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h2",{attrs:{id:"字符串操作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#字符串操作"}},[s._v("#")]),s._v(" 字符串操作")]),s._v(" "),a("h4",{attrs:{id:"操作指令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#操作指令"}},[s._v("#")]),s._v(" 操作指令")]),s._v(" "),a("h6",{attrs:{id:"设置值"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#设置值"}},[s._v("#")]),s._v(" 设置值")]),s._v(" "),a("p",[s._v("赋值指令如下所示，"),a("code",[s._v("]")]),s._v("为可选项")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("set key value ex  value 秒级过期时间] px value 设置当前键值对的毫秒级过期时间]  nx 若键值存在才能赋值] xx 若键值存在才能赋值]\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("示例 设置一个key为str，value为hello的字符串")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("127.0.0.1:6379> set str hello\nOK\n127.0.0.1:6379>\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("设置一个10s过期的字符串str2，值为str2")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('127.0.0.1:6379> set str2 str2 ex 10\nOK\n## 10s内值还在\n127.0.0.1:6379> get str2\n"str2"\n\n## 10s后键值对消失\n127.0.0.1:6379> get str2\n(nil)\n127.0.0.1:6379>\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("h6",{attrs:{id:"setnx、setxx、setex"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#setnx、setxx、setex"}},[s._v("#")]),s._v(" setnx、setxx、setex")]),s._v(" "),a("p",[s._v("setnx和set的nx选项类似，值不存在时才能建立键值对")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("setnx key value\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("示例")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('## 判断hello是否存在\n127.0.0.1:6379> EXISTS hello\n(integer) 0\n## 设置hello\n127.0.0.1:6379> set hello world\nOK\n## 如果hello不存在 则设置一个key为hello value为h的键值对\n127.0.0.1:6379> SETNX hello h\n(integer) 0\n## 发现值没变还是原本set指令的\n127.0.0.1:6379> get hello\n"world"\n## h不存在\n127.0.0.1:6379> EXISTS h\n(integer) 0\n## 使用setnx赋值，在使用get指令查看，发现存在\n127.0.0.1:6379> SETNX h hello\n(integer) 1\n127.0.0.1:6379> get h\n"hello"\n127.0.0.1:6379>\n\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br")])]),a("p",[s._v("setxx相对set指令的xx选项，这里就不多赘述了")]),s._v(" "),a("p",[s._v("setex相当于set指令的ex选项")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('## 设置一个10s过期的键为key 值为value的键值对\n127.0.0.1:6379> SETEX key 10 value\nOK\n127.0.0.1:6379> get key\n"value"\n## 10s后过期\n127.0.0.1:6379> get key\n(nil)\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h6",{attrs:{id:"获取值"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#获取值"}},[s._v("#")]),s._v(" 获取值")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("get key\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h6",{attrs:{id:"批量设置值和获取值"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#批量设置值和获取值"}},[s._v("#")]),s._v(" 批量设置值和获取值")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("## 批量设置\nmset key value key value] key value] key value]\n## 批量获取\nmget key1 key2 ....\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("示例")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('127.0.0.1:6379> MSET a 1 b 2 c 3\nOK\n127.0.0.1:6379> MGET a b c\n1) "1"\n2) "2"\n3) "3"\n\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[s._v("注意:如果我们某个业务需要获取redis中大量的key值，建议使用mget，原因：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("使用set获取1000个key: 1000个网络io时间+1000个指令执行时间\n使用mget获取1000个key:1个网络io时间+1000个指令执行时间\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("get指令请求模型")]),s._v(" "),a("p",[s._v("mget指令请求模型")]),s._v(" "),a("h6",{attrs:{id:"计数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#计数"}},[s._v("#")]),s._v(" 计数")]),s._v(" "),a("p",[s._v("自增指令，若值不存在，则创建并初始值为1，若存在且为整数则自增，若存在且为字符文字则报错。 因为redis是单线程的，所以计数指令无需考虑线程安全问题，无需使用cas等手段来修改值而是顺序执行自增，所以性能相当优秀。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("incr key\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("示例")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("127.0.0.1:6379> INCR k\n(integer) 1\n127.0.0.1:6379> INCR k\n(integer) 2\n127.0.0.1:6379> set str str\nOK\n127.0.0.1:6379> incr str\n(error) ERR value is not an integer or out of range\n127.0.0.1:6379>\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("p",[s._v("其他计数指令")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("## 自减\ndecr key\n## 自增自己指定的值\nincrby key increment\n## 自减指定的值\ndecrby key decrement\n## 自增小数值\nincrbyfloat key increment\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h6",{attrs:{id:"不常用指令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#不常用指令"}},[s._v("#")]),s._v(" 不常用指令")]),s._v(" "),a("p",[s._v("追加值")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("append key value\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("示例")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('## 对key为hello的值增加一个world字符串\n127.0.0.1:6379> set hello hello\nOK\n127.0.0.1:6379> APPEND hello world\n(integer) 10\n127.0.0.1:6379> get hello\n"helloworld"\n127.0.0.1:6379>\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[s._v("获取字符串长度")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("strlen key\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("示例")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("127.0.0.1:6379> strlen hello\n(integer) 10\n127.0.0.1:6379>\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("设置并返回原先的值")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("getset key value\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("示例")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('127.0.0.1:6379> set hello world\nOK\n127.0.0.1:6379> GETSET hello redis\n"world"\n127.0.0.1:6379>\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("获取指定范围")]),s._v(" "),a("p",[s._v("语法")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v(" GETRANGE key start  end\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("示例")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('127.0.0.1:6379> set str 0123456789\nOK\n127.0.0.1:6379> GETRANGE str 0  2\n"012"\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h4",{attrs:{id:"不同长度的字符串的内部编码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#不同长度的字符串的内部编码"}},[s._v("#")]),s._v(" 不同长度的字符串的内部编码")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('## 8位数的长整型为int\n127.0.0.1:6379> set str 111\nOK\n127.0.0.1:6379> object encoding str\n"int"\n\n## 小于39字节的字符串为embstr\n127.0.0.1:6379> set str helloworld\nOK\n127.0.0.1:6379> object encoding str\n"embstr"\n\n## 大于39字节为raw\n127.0.0.1:6379> set str abcdefghijklmnopqrstudksajdlksadklsdaskdjlkasdjasdjajdlksadadjl\nOK\n127.0.0.1:6379> object encoding str\n"raw"\n127.0.0.1:6379>\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br")])]),a("h4",{attrs:{id:"使用场景"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用场景"}},[s._v("#")]),s._v(" 使用场景")]),s._v(" "),a("h6",{attrs:{id:"用户信息缓存"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#用户信息缓存"}},[s._v("#")]),s._v(" 用户信息缓存")]),s._v(" "),a("p",[s._v("如下所示，可将常见的数据库数据存到redis中提高访问数据，建议使用的key为"),a("code",[s._v("表名:对象名:id")]),s._v(",例如"),a("code",[s._v("userInfo:user:1")])]),s._v(" "),a("p",[s._v("伪代码示例")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('UserInfo getUserInfo(long id){\nuserRedisKey = "user:info:" + id\nvalue = redis.get(userRedisKey);\nUserInfo userInfo;\nif (value != null) {\nuserInfo = deserialize(value);\n} else {\nuserInfo = mysql.get(id);\nif (userInfo != null)\nredis.setex(userRedisKey, 3600, serialize(userInfo));\n}\nreturn userInfo;\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("h6",{attrs:{id:"视频播放量计数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#视频播放量计数"}},[s._v("#")]),s._v(" 视频播放量计数")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('long incrVideoCounter(long id) {\nkey = "video:playCount:" + id;\nreturn redis.incr(key);\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h6",{attrs:{id:"共享session"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#共享session"}},[s._v("#")]),s._v(" 共享session")]),s._v(" "),a("p",[s._v("为了保证用户在集群场景下能够公用一个会话session，我们会另起一台服务器搭建redis服务保存会话session，避免用户因为负载均衡在各个服务器之间时重复登录。")]),s._v(" "),a("h6",{attrs:{id:"短信限速"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#短信限速"}},[s._v("#")]),s._v(" 短信限速")]),s._v(" "),a("p",[s._v("避免单用户一分钟不能超过5次访问")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('phoneNum = "138xxxxxxxx";\nkey = "shortMsg:limit:" + phoneNum;\n// SET key value EX 60 NX\nisExists = redis.set(key,1,"EX 60","NX");\nif(isExists != null || redis.incr(key) <=5){\n//  通过\n}else{\n//  限速\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("h2",{attrs:{id:"哈希"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#哈希"}},[s._v("#")]),s._v(" 哈希")]),s._v(" "),a("h4",{attrs:{id:"简介"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#简介"}},[s._v("#")]),s._v(" 简介")]),s._v(" "),a("p",[s._v("存储键值对的数据结构，也叫映射，字典")]),s._v(" "),a("h4",{attrs:{id:"操作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#操作"}},[s._v("#")]),s._v(" 操作")]),s._v(" "),a("h6",{attrs:{id:"设置值和取值"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#设置值和取值"}},[s._v("#")]),s._v(" 设置值和取值")]),s._v(" "),a("p",[s._v("语法")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("## 设置值\nHSET key field value\n## 获取值\nHGET key field\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("示例")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('127.0.0.1:6379> HSET hashmap key1 value1 key2 value2\n(integer) 2\n127.0.0.1:6379> HGET hashmap key1\n"value1"\n127.0.0.1:6379>\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h6",{attrs:{id:"删除哈希一个键"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#删除哈希一个键"}},[s._v("#")]),s._v(" 删除哈希一个键")]),s._v(" "),a("p",[s._v("语法")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("HDEL key field\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("格式")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("## 删除hashmap的key1\n127.0.0.1:6379> HDEL hashmap key1\n(integer) 1\n127.0.0.1:6379>\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h6",{attrs:{id:"计算哈希的key的个数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#计算哈希的key的个数"}},[s._v("#")]),s._v(" 计算哈希的key的个数")]),s._v(" "),a("p",[s._v("语法")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("HLEN key\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("示例")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("127.0.0.1:6379> HLEN hashmap\n(integer) 1\n127.0.0.1:6379>\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h6",{attrs:{id:"批量设置哈希的值和批量获取哈希的值"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#批量设置哈希的值和批量获取哈希的值"}},[s._v("#")]),s._v(" 批量设置哈希的值和批量获取哈希的值")]),s._v(" "),a("p",[s._v("语法")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v(" HMSET key  field value field value] field value]\n HMGET key  field field] field] field]\n\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("示例")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('127.0.0.1:6379> HMSET user:1 name xiaoming age 18 city fujian\nOK\n127.0.0.1:6379> HMGET user:1 name age city\n1) "xiaoming"\n2) "18"\n3) "fujian"\n127.0.0.1:6379>\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h6",{attrs:{id:"判断键值对是否存在"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#判断键值对是否存在"}},[s._v("#")]),s._v(" 判断键值对是否存在")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("127.0.0.1:6379> HEXISTS key field\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("示例")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("127.0.0.1:6379> HEXISTS user:1 name\n(integer) 1\n127.0.0.1:6379>\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h6",{attrs:{id:"获取所有key、获取所有value、获取所有的key-value"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#获取所有key、获取所有value、获取所有的key-value"}},[s._v("#")]),s._v(" 获取所有key、获取所有value、获取所有的key-value")]),s._v(" "),a("p",[s._v("语法")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("## 获取所有key\nHKEYS key\n\n## 获取所有value\n HVALS  key\n\n## 获取所有key-value\nHGETALL key\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[s._v("示例")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('127.0.0.1:6379> HKEYS user:1\n1) "name"\n2) "age"\n3) "city"\n127.0.0.1:6379> HVALS user:1\n1) "xiaoming"\n2) "18"\n3) "fujian"\n127.0.0.1:6379> HGETALL user:1\n1) "name"\n2) "xiaoming"\n3) "age"\n4) "18"\n5) "city"\n6) "fujian"\n127.0.0.1:6379>\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])]),a("p",[s._v("建议:若哈希中存在多个键值对且我们需要一次性获取，建议使用hscan而不是hmget，避免造成redis阻塞")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('## 使用hscan从0位置获取所有键值对\n127.0.0.1:6379> HSCAN user:1 0\n1) "0"\n2) 1) "name"\n   2) "xiaoming"\n   3) "age"\n   4) "18"\n   5) "city"\n   6) "fujian"\n127.0.0.1:6379>\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("h6",{attrs:{id:"hincrby-hincrbyfloat"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#hincrby-hincrbyfloat"}},[s._v("#")]),s._v(" hincrby hincrbyfloat")]),s._v(" "),a("p",[s._v("和incr类似，只不过增长的是field的值")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("hincrby key field\nhincrbyfloat key field\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h6",{attrs:{id:"计算field的长度"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#计算field的长度"}},[s._v("#")]),s._v(" 计算field的长度")]),s._v(" "),a("p",[s._v("语法")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("hstrlen key field\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("示例")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("获取user:1 的name的长度\n127.0.0.1:6379> HSTRLEN user:1 name\n(integer) 8\n127.0.0.1:6379>\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h6",{attrs:{id:"内部编码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#内部编码"}},[s._v("#")]),s._v(" 内部编码")]),s._v(" "),a("p",[s._v("在键值对个数小于512且所有值都小于64字节时，哈希的内部编码为ziplist，当超过这些限制时使用的就是hashtable(超过限制后使用这种数据结构时间复杂度更低,查询效率为O(1))。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('## 小于64字节为ziplist\n127.0.0.1:6379> hset user:1 name xiaoming\n(integer) 0\n127.0.0.1:6379> object encoding user:1\n"ziplist"\n## 超过后为hashtable\n127.0.0.1:6379> hset user:1 name djdjkhdjhdhdhwhquehqhdjksdhqjhdjkojhdlksadsahdjsalkhdjlksahdjoaehduioqwajwksdhjaksdhjsahdsajkdhjslkadhjlksahdjksahdjksahdjk\n(integer) 0\n127.0.0.1:6379> object encoding user:1\n"hashtable"\n\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("h4",{attrs:{id:"使用场景-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用场景-2"}},[s._v("#")]),s._v(" 使用场景")]),s._v(" "),a("p",[s._v("如果我们要缓存某行用户信息，使用哈希非常合适不过")]),s._v(" "),a("p",[s._v("原因如下:")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v(" 1. 相较于字符串(占用过多的键)，哈希内聚更好更易于维护大量的用户信息\n 2. 如果使用字符串进行序列化存储，就会造成网络io时序列化和反序列化的开销\n 3. 操作简单，修改用户字段更加方便\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("需要注意:哈希存储相对二维表更加稀疏，如上图，二维表中null的数据，在哈希表中key是完全不存在的用户使用时需要考虑到这一点。")]),s._v(" "),a("h2",{attrs:{id:"列表"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#列表"}},[s._v("#")]),s._v(" 列表")]),s._v(" "),a("h4",{attrs:{id:"简介-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#简介-2"}},[s._v("#")]),s._v(" 简介")]),s._v(" "),a("p",[s._v("线性结构，允许重复元素，可以充当队列和栈。")]),s._v(" "),a("h4",{attrs:{id:"操作-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#操作-2"}},[s._v("#")]),s._v(" 操作")]),s._v(" "),a("h6",{attrs:{id:"添加"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#添加"}},[s._v("#")]),s._v(" 添加")]),s._v(" "),a("p",[s._v("从右边插入，语法:")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("RPUSH key value value]\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("示例")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('## 右边一次插入a b c\n127.0.0.1:6379> RPUSH list a b c\n(integer) 3\n## 查看list的元素\n127.0.0.1:6379> LRANGE list 0 -1\n1) "a"\n2) "b"\n3) "c"\n127.0.0.1:6379>\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("p",[s._v("从左边插入元素 lpush")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('LPUSH key value value...]\n## 从左边依次插入\n127.0.0.1:6379> LPUSH arr a b c\n(integer) 3\n## 查看最终的元素值\n127.0.0.1:6379> LRANGE arr 0 -1\n1) "c"\n2) "b"\n3) "a"\n127.0.0.1:6379>\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("p",[s._v("向元素前或者后添加元素")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("linsert key before|after pivot value\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("示例：向a后面添加一个元素a+")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('127.0.0.1:6379> LRANGE list 0 -1\n1) "a"\n2) "b"\n3) "c"\n127.0.0.1:6379> LINSERT list after a a+\n(integer) 4\n127.0.0.1:6379> LRANGE list 0 -1\n1) "a"\n2) "a+"\n3) "b"\n4) "c"\n127.0.0.1:6379>\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("h6",{attrs:{id:"查询"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查询"}},[s._v("#")]),s._v(" 查询")]),s._v(" "),a("p",[s._v("查找指定范围的元素")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("lrange key start end\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("示例")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('## 查看list的所有元素\n127.0.0.1:6379> LRANGE list 0 -1\n1) "a"\n2) "a+"\n3) "b"\n4) "c"\n##  查看一个不存在的key的元素\n127.0.0.1:6379> LRANGE key 1 2\n(empty array)\n## 查看list 2-3的元素\n127.0.0.1:6379> LRANGE list 1 2\n1) "a+"\n2) "b"\n127.0.0.1:6379>\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("p",[s._v("获取指定索引的元素")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("lindex key index\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("示例:查看key为list第0个元素")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('127.0.0.1:6379> LRANGE list 0 -1\n1) "a"\n2) "a+"\n3) "b"\n4) "c"\n127.0.0.1:6379> LINDEX list 0\n"a"\n127.0.0.1:6379>\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[s._v("获取列表长度")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("llen key\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("示例")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('127.0.0.1:6379> LRANGE list 0 -1\n1) "a"\n2) "a+"\n3) "b"\n4) "c"\n127.0.0.1:6379> LLEN list\n(integer) 4\n127.0.0.1:6379>\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("h6",{attrs:{id:"删除"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#删除"}},[s._v("#")]),s._v(" 删除")]),s._v(" "),a("p",[s._v("从列表左侧弹出元素")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("lpop key\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("示例")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('127.0.0.1:6379> LRANGE list 0 -1\n1) "a"\n2) "a+"\n3) "b"\n4) "c"\n127.0.0.1:6379> LPOP list\n"a"\n127.0.0.1:6379> LRANGE list 0 -1\n1) "a+"\n2) "b"\n3) "c"\n127.0.0.1:6379>\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("p",[s._v("同理右侧为rpop，不多赘述")]),s._v(" "),a("p",[s._v("删除元素")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("lrem key count value\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("count的大小有以下几种情况")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("1. 大于0，从左到右删除count个元素\n2. 小于0，从右到左删除count个元素\n3. =0 删除所有元素\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("示例:从左到右删除一个为a的元素")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('127.0.0.1:6379> LRANGE list 0 -1\n1) "a+"\n2) "b"\n3) "c"\n127.0.0.1:6379> LREM list 1 b\n(integer) 1\n127.0.0.1:6379> LRANGE list 0 -1\n1) "a+"\n2) "c"\n127.0.0.1:6379>\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("p",[s._v("修剪列表至指定索引范围")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("ltrim key start end\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("示例，将列表修剪为只有2 15索引范围内的元素")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('127.0.0.1:6379> LRANGE list 0 -1\n 1) "a+"\n 2) "z"\n 3) "a"\n 4) "b"\n 5) "c"\n 6) "d"\n 7) "e"\n 8) "f"\n 9) "g"\n10) "h"\n11) "i"\n12) "j"\n13) "k"\n14) "l"\n15) "m"\n16) "n"\n127.0.0.1:6379> LTRIM list 2 15\nOK\n127.0.0.1:6379> LRANGE list 0 -1\n 1) "a"\n 2) "b"\n 3) "c"\n 4) "d"\n 5) "e"\n 6) "f"\n 7) "g"\n 8) "h"\n 9) "i"\n10) "j"\n11) "k"\n12) "l"\n13) "m"\n14) "n"\n127.0.0.1:6379>\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br")])]),a("h6",{attrs:{id:"修改"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#修改"}},[s._v("#")]),s._v(" 修改")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("lset key index newValue\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h6",{attrs:{id:"阻塞操作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#阻塞操作"}},[s._v("#")]),s._v(" 阻塞操作")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("blpop key key ...] timeout\nbrpop key key ...] timeout\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("brpop 示例，当timeout大于0时，若有元素立即返回，若没有则等到对应时间为止 若timeout设置为0，则无限等待，如下所示，笔者使用另一个客户端push一个元素进来，这个阻塞就会立刻将这个元素弹出。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('127.0.0.1:6379> BRPOP arr 3\n1) "arr"\n2) "a"\n127.0.0.1:6379> BRPOP arr 3\n1) "arr"\n2) "b"\n127.0.0.1:6379> BRPOP arr 3\n1) "arr"\n2) "c"\n127.0.0.1:6379> BRPOP arr 3\n(nil)\n(3.04s)\n127.0.0.1:6379> BRPOP arr 3\n(nil)\n(3.07s)\n127.0.0.1:6379> BRPOP arr 0\n1) "arr"\n2) "a"\n(43.69s)\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("h6",{attrs:{id:"内部编码-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#内部编码-2"}},[s._v("#")]),s._v(" 内部编码")]),s._v(" "),a("p",[s._v("当内部元素个数小于512，且每个元素小于64字节，列表默认使用ziplist，反之就会使用linklist")]),s._v(" "),a("h6",{attrs:{id:"使用场景-3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用场景-3"}},[s._v("#")]),s._v(" 使用场景")]),s._v(" "),a("p",[s._v("Redis的lpush+brpop命令组合即可实现阻塞队列，如下图，每个消费者只需要关注自己感兴趣的专题即可，作为生产者只需不断使lpush添加专题即可。")]),s._v(" "),a("p",[s._v("关于列表更多用法可以参见以下口诀")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("1. lpush+lpop=Stack（栈）\n2. lpush+rpop=Queue（队列）\n3. lpsh+ltrim=Capped Collection（有限集合）\n4. lpush+brpop=Message Queue（消息队列）\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h2",{attrs:{id:"集合"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#集合"}},[s._v("#")]),s._v(" 集合")]),s._v(" "),a("h4",{attrs:{id:"特点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#特点"}},[s._v("#")]),s._v(" 特点")]),s._v(" "),a("ol",[a("li",[s._v("最多可存储2^32-1个元素")]),s._v(" "),a("li",[s._v("集合内部元素不重复")])]),s._v(" "),a("h4",{attrs:{id:"命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#命令"}},[s._v("#")]),s._v(" 命令")]),s._v(" "),a("h6",{attrs:{id:"添加元素"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#添加元素"}},[s._v("#")]),s._v(" 添加元素")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("sadd key element element ...]\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("示例，可以看到第2次添加的元素并没有成功")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("127.0.0.1:6379> SADD set a b c\n(integer) 3\n127.0.0.1:6379> SADD set a b\n(integer) 0\n127.0.0.1:6379>\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h6",{attrs:{id:"删除元素"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#删除元素"}},[s._v("#")]),s._v(" 删除元素")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("srem key element element ...]\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h6",{attrs:{id:"计算集合大小"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#计算集合大小"}},[s._v("#")]),s._v(" 计算集合大小")]),s._v(" "),a("p",[s._v("注意，这个计算的时间复杂度为O(1)，因为获得的这个集合的大小并不是计算来的，而是通过redis维护的一个内部变量得来的。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("scard key\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h6",{attrs:{id:"判断元素是否在集合中"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#判断元素是否在集合中"}},[s._v("#")]),s._v(" 判断元素是否在集合中")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("sismember key element\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("示例")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("127.0.0.1:6379> SISMEMBER set a\n(integer) 1\n127.0.0.1:6379> SISMEMBER set ac\n(integer) 0\n127.0.0.1:6379>\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h6",{attrs:{id:"随机获取集合内的元素"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#随机获取集合内的元素"}},[s._v("#")]),s._v(" 随机获取集合内的元素")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("srandmember key count]\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("示例")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('127.0.0.1:6379> SRANDMEMBER set 1\n1) "a"\n127.0.0.1:6379> SRANDMEMBER set 1\n1) "c"\n127.0.0.1:6379>\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h6",{attrs:{id:"随机弹出一个元素"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#随机弹出一个元素"}},[s._v("#")]),s._v(" 随机弹出一个元素")]),s._v(" "),a("p",[s._v("与srandmember 差不多，只不过该操作会将元素输出并将集合中的这个元素删除")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("spop key\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("示例")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('127.0.0.1:6379> SPOP set\n"c"\n127.0.0.1:6379> SPOP set\n"a"\n127.0.0.1:6379> SPOP set\n"b"\n127.0.0.1:6379> SPOP set\n(nil)\n127.0.0.1:6379> SPOP set\n(nil)\n127.0.0.1:6379> SPOP set\n(nil)\n127.0.0.1:6379> SPOP set\n(nil)\n127.0.0.1:6379> SPOP set\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("h6",{attrs:{id:"获取所有元素"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#获取所有元素"}},[s._v("#")]),s._v(" 获取所有元素")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("smembers key\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h6",{attrs:{id:"获取两个集合之间的交集"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#获取两个集合之间的交集"}},[s._v("#")]),s._v(" 获取两个集合之间的交集")]),s._v(" "),a("p",[s._v("语法")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("sinter key key ...]\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("示例，可以看出set1和set2的交集为a")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('127.0.0.1:6379> SADD set1 a b c d\n(integer) 4\n127.0.0.1:6379> SADD set2 a e f g h\n(integer) 5\n127.0.0.1:6379> SINTER set1 set2\n1) "a"\n127.0.0.1:6379>\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h6",{attrs:{id:"求并集"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#求并集"}},[s._v("#")]),s._v(" 求并集")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("suinon key key ...]\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h6",{attrs:{id:"求差集"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#求差集"}},[s._v("#")]),s._v(" 求差集")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("sdiff key key ...]\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("示例，注意这个差集指的是第一个集合有，其他集合没有的元素")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('127.0.0.1:6379> SDIFF set1 set2\n1) "b"\n2) "d"\n3) "c"\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h6",{attrs:{id:"将交集、差集、并集结果保存"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#将交集、差集、并集结果保存"}},[s._v("#")]),s._v(" 将交集、差集、并集结果保存")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("sinterstore destination key key ...]\nsuionstore destination key key ...]\nsdiffstore destination key key ...]\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("示例:将并集的结果保存")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('127.0.0.1:6379> SADD set1 a b c d\n(integer) 4\n127.0.0.1:6379> SADD set2 a e f g h\n(integer) 5\n127.0.0.1:6379> SINTERstore set3 set1 set2\n(integer) 1\n127.0.0.1:6379> SMEMBERS set3\n1) "a"\n127.0.0.1:6379>\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("h4",{attrs:{id:"内部编码-3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#内部编码-3"}},[s._v("#")]),s._v(" 内部编码")]),s._v(" "),a("p",[s._v("当元素为整数且大小小于512时会使用intset(节省内存)，反之就会转为hashtable提高效率。")]),s._v(" "),a("h4",{attrs:{id:"使用场景-4"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用场景-4"}},[s._v("#")]),s._v(" 使用场景")]),s._v(" "),a("ol",[a("li",[s._v("sadd=Tagging（标签,例如交友网站个人标签）")]),s._v(" "),a("li",[s._v("spop/srandmember=Random item（生成随机数，比如抽奖）")]),s._v(" "),a("li",[s._v("sadd+sinter=Social Graph（社交需求，与附近的人爱好匹配）")])]),s._v(" "),a("h2",{attrs:{id:"有序集合"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#有序集合"}},[s._v("#")]),s._v(" 有序集合")]),s._v(" "),a("h4",{attrs:{id:"简介-3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#简介-3"}},[s._v("#")]),s._v(" 简介")]),s._v(" "),a("ol",[a("li",[s._v("相较于集合，增加一个score属性，使得整体有序。")]),s._v(" "),a("li",[s._v("集合元素不可重复，但是score可以重复。")])]),s._v(" "),a("h4",{attrs:{id:"指令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#指令"}},[s._v("#")]),s._v(" 指令")]),s._v(" "),a("h6",{attrs:{id:"添加成员"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#添加成员"}},[s._v("#")]),s._v(" 添加成员")]),s._v(" "),a("p",[s._v("命令")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("zadd key score member score member ...]\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("示例")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("127.0.0.1:6379> zadd zset 1 tom 2 jack 3 lucy\n(integer) 3\n127.0.0.1:6379>\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("可选项")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("1. nx：member必须不存在，才可以设置成功，用于添加。\n2. xx：member必须存在，才可以设置成功，用于更新。\n3. ch：返回此次操作后，有序集合元素和分数发生变化的个数\n4. incr：对score做增加，相当于后面介绍的zincrby。\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("示例:如果tom存在，给tom自增。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('127.0.0.1:6379> zadd zset xx incr 1 tom\n"2"\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("相比于集合，有序集合增加了排序的操作，添加成员的时间复杂度由原来的"),a("code",[s._v("O(1)")]),s._v("变为"),a("code",[s._v("O(logn)")])]),s._v(" "),a("h6",{attrs:{id:"计算有序集合的大小"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#计算有序集合的大小"}},[s._v("#")]),s._v(" 计算有序集合的大小")]),s._v(" "),a("p",[s._v("于scard一样，时间复杂度也是"),a("code",[s._v("O(1)")])]),s._v(" "),a("p",[s._v("指令")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("zcard key\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("示例")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("127.0.0.1:6379> ZCARD zset\n(integer) 3\n127.0.0.1:6379>\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h6",{attrs:{id:"查看成员分数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看成员分数"}},[s._v("#")]),s._v(" 查看成员分数")]),s._v(" "),a("p",[s._v("指令")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("zscore key member\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("示例")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('127.0.0.1:6379> zscore zset tom\n"3"\n127.0.0.1:6379> zscore zset jack\n"2"\n127.0.0.1:6379> zscore zset xiaoming\n(nil)\n127.0.0.1:6379>\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h6",{attrs:{id:"计算成员排名"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#计算成员排名"}},[s._v("#")]),s._v(" 计算成员排名")]),s._v(" "),a("p",[s._v("命令")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("## 升序排名\nzrank key member\n## 降序排名\nzrevrank key member\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("示例")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("127.0.0.1:6379> ZRANK zset tom\n(integer) 2\n127.0.0.1:6379> ZrevRANK zset tom\n(integer) 0\n127.0.0.1:6379>\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h6",{attrs:{id:"删除成员"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#删除成员"}},[s._v("#")]),s._v(" 删除成员")]),s._v(" "),a("p",[s._v("命令")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("zrem key member member ...]\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("示例")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("127.0.0.1:6379> ZREM zset tom jack\n(integer) 2\n127.0.0.1:6379>\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h6",{attrs:{id:"给成员增加分数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#给成员增加分数"}},[s._v("#")]),s._v(" 给成员增加分数")]),s._v(" "),a("p",[s._v("指令")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("zincrby key increment member\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("示例")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('127.0.0.1:6379> ZINCRBY zset 100 tom\n"100"\n127.0.0.1:6379> ZINCRBY zset 100 tom\n"200"\n127.0.0.1:6379>\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h6",{attrs:{id:"查看排名"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看排名"}},[s._v("#")]),s._v(" 查看排名")]),s._v(" "),a("p",[s._v("指令")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("zrange key start end withscores]\nzrevrange key start end withscores]\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("示例")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('127.0.0.1:6379> ZRANGE zset 0 -1 withscores\n1) "lucy"\n2) "3"\n3) "tom"\n4) "200"\n127.0.0.1:6379>\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("h6",{attrs:{id:"返回指定分数范围的成员"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#返回指定分数范围的成员"}},[s._v("#")]),s._v(" 返回指定分数范围的成员")]),s._v(" "),a("p",[s._v("指令")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("zrangebyscore key min max withscores] limit offset count]\nzrevrangebyscore key max min withscores] limit offset count]\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("示例")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('127.0.0.1:6379> ZRANGEBYSCORE zset 0 300 withscores\n1) "lucy"\n2) "3"\n3) "tom"\n4) "200"\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("获取10到无限大的成员")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('127.0.0.1:6379> ZRANGEBYSCORE zset (10 +inf withscores\n1) "liu"\n2) "11"\n3) "tom"\n4) "200"\n127.0.0.1:6379>\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("h6",{attrs:{id:"获取指定分数范围内的用户"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#获取指定分数范围内的用户"}},[s._v("#")]),s._v(" 获取指定分数范围内的用户")]),s._v(" "),a("p",[s._v("指令")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("zcount key min max\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("示例")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("127.0.0.1:6379> ZCOUNT zset 0 10\n(integer) 2\n127.0.0.1:6379>\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h6",{attrs:{id:"删除指定排名内的用户"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#删除指定排名内的用户"}},[s._v("#")]),s._v(" 删除指定排名内的用户")]),s._v(" "),a("p",[s._v("指令")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("zremrangebyrank key start end\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("示例:删除前3名成员")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("127.0.0.1:6379> ZREMRANGEBYRANK zset 0 2\n(integer) 3\n127.0.0.1:6379>\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h6",{attrs:{id:"删除指定分数范围内的用户"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#删除指定分数范围内的用户"}},[s._v("#")]),s._v(" 删除指定分数范围内的用户")]),s._v(" "),a("p",[s._v("指令")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("zremrangebyscore key min max\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("示例")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("127.0.0.1:6379> ZREMRANGEBYSCORE zset (250 +inf\n(integer) 1\n127.0.0.1:6379>\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h4",{attrs:{id:"内部编码-4"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#内部编码-4"}},[s._v("#")]),s._v(" 内部编码")]),s._v(" "),a("p",[s._v("当集合size小于512且每个字符串大小不超过64字节时，有序集合使用的时ziplist，反之就是使用调表。从设计的角度来看，使用平衡树或者红黑树也能解决问题，但是跳表的实现相较于前者更加简单。查询也差不多。")]),s._v(" "),a("h4",{attrs:{id:"使用场景-5"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用场景-5"}},[s._v("#")]),s._v(" 使用场景")]),s._v(" "),a("p",[s._v("常用于点赞、播放量等排行榜")]),s._v(" "),a("p",[s._v("如下就模拟了点赞排行榜的操作")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('## 小明获得10个赞\n127.0.0.1:6379> zadd user:ranking:20220810 10 xiaoming\n(integer) 1\n## 小王获得11个赞\n127.0.0.1:6379> zadd user:ranking:20220810 11 xiaowang\n(integer) 1\n## 小刘获得8个赞\n127.0.0.1:6379> zadd user:ranking:20220810 8 xiaoliu\n(integer) 1\n## 小刘的赞+1\n127.0.0.1:6379> zincrby user:ranking:20220810  1  xiaoliu\n"9"\n## 查看排名前3\n127.0.0.1:6379> zrevrange user:ranking:20220810 0 2\n1) "xiaowang"\n2) "xiaoming"\n3) "xiaoliu"\n## 小刘被取消一个赞\n127.0.0.1:6379> zincrby user:ranking:20220810  -1  xiaoliu\n"8"\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])])])}),[],!1,null,null,null);a.default=t.exports}}]);