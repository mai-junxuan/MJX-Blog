<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>nginx基础入门 | 麦俊轩的博客</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="">
    <meta name="robots" content="all">
    <meta name="author" content="mjx">
    <meta name="apple-mobile-web-app-capable" content="yes">
    
    <link rel="preload" href="/assets/css/0.styles.38934ce7.css" as="style"><link rel="preload" href="/assets/js/app.66e71283.js" as="script"><link rel="preload" href="/assets/js/2.2d1cac8d.js" as="script"><link rel="preload" href="/assets/js/1.ab819bd9.js" as="script"><link rel="preload" href="/assets/js/74.f547417c.js" as="script"><link rel="prefetch" href="/assets/js/10.84d14364.js"><link rel="prefetch" href="/assets/js/11.045a0a60.js"><link rel="prefetch" href="/assets/js/12.6f0e9932.js"><link rel="prefetch" href="/assets/js/13.fb842719.js"><link rel="prefetch" href="/assets/js/14.f4937493.js"><link rel="prefetch" href="/assets/js/15.f4b2583c.js"><link rel="prefetch" href="/assets/js/16.41b572be.js"><link rel="prefetch" href="/assets/js/17.8f245198.js"><link rel="prefetch" href="/assets/js/18.4c44bfad.js"><link rel="prefetch" href="/assets/js/19.46b03286.js"><link rel="prefetch" href="/assets/js/20.756867c9.js"><link rel="prefetch" href="/assets/js/21.2957c140.js"><link rel="prefetch" href="/assets/js/22.b345e7c5.js"><link rel="prefetch" href="/assets/js/23.d83d718a.js"><link rel="prefetch" href="/assets/js/24.d9975f36.js"><link rel="prefetch" href="/assets/js/25.7a4b71c9.js"><link rel="prefetch" href="/assets/js/26.cee50e0c.js"><link rel="prefetch" href="/assets/js/27.2bd584b7.js"><link rel="prefetch" href="/assets/js/28.40a4b61a.js"><link rel="prefetch" href="/assets/js/29.b28882d0.js"><link rel="prefetch" href="/assets/js/3.9afe9595.js"><link rel="prefetch" href="/assets/js/30.cbf9f923.js"><link rel="prefetch" href="/assets/js/31.9e279d6d.js"><link rel="prefetch" href="/assets/js/32.de890c1b.js"><link rel="prefetch" href="/assets/js/33.2edb4675.js"><link rel="prefetch" href="/assets/js/34.b10912b9.js"><link rel="prefetch" href="/assets/js/35.72464f81.js"><link rel="prefetch" href="/assets/js/36.0170a5ad.js"><link rel="prefetch" href="/assets/js/37.440103ea.js"><link rel="prefetch" href="/assets/js/38.fe4d020a.js"><link rel="prefetch" href="/assets/js/39.00806ff5.js"><link rel="prefetch" href="/assets/js/4.7daf21de.js"><link rel="prefetch" href="/assets/js/40.f91742c2.js"><link rel="prefetch" href="/assets/js/41.36d0ea03.js"><link rel="prefetch" href="/assets/js/42.c7dc16b4.js"><link rel="prefetch" href="/assets/js/43.84214d9d.js"><link rel="prefetch" href="/assets/js/44.2537628d.js"><link rel="prefetch" href="/assets/js/45.6588b1e4.js"><link rel="prefetch" href="/assets/js/46.20177a10.js"><link rel="prefetch" href="/assets/js/47.0dcf0b55.js"><link rel="prefetch" href="/assets/js/48.fb38c2ca.js"><link rel="prefetch" href="/assets/js/49.31712729.js"><link rel="prefetch" href="/assets/js/5.ae530a1a.js"><link rel="prefetch" href="/assets/js/50.4230d5ad.js"><link rel="prefetch" href="/assets/js/51.bda4cdd5.js"><link rel="prefetch" href="/assets/js/52.ab24e96b.js"><link rel="prefetch" href="/assets/js/53.c273b7a8.js"><link rel="prefetch" href="/assets/js/54.16f3f38e.js"><link rel="prefetch" href="/assets/js/55.a37b8f6c.js"><link rel="prefetch" href="/assets/js/56.b59cdd58.js"><link rel="prefetch" href="/assets/js/57.fcc7b064.js"><link rel="prefetch" href="/assets/js/58.c26f6871.js"><link rel="prefetch" href="/assets/js/59.f8b14dda.js"><link rel="prefetch" href="/assets/js/6.d389c045.js"><link rel="prefetch" href="/assets/js/60.02142959.js"><link rel="prefetch" href="/assets/js/61.7cbefbdb.js"><link rel="prefetch" href="/assets/js/62.c1c42d03.js"><link rel="prefetch" href="/assets/js/63.9cf5c587.js"><link rel="prefetch" href="/assets/js/64.15de1976.js"><link rel="prefetch" href="/assets/js/65.2f4c079e.js"><link rel="prefetch" href="/assets/js/66.47253488.js"><link rel="prefetch" href="/assets/js/67.68a40463.js"><link rel="prefetch" href="/assets/js/68.cbfe3485.js"><link rel="prefetch" href="/assets/js/69.4e7fb2ee.js"><link rel="prefetch" href="/assets/js/7.c9f32eab.js"><link rel="prefetch" href="/assets/js/70.dded6a7a.js"><link rel="prefetch" href="/assets/js/71.31edd10e.js"><link rel="prefetch" href="/assets/js/72.1d6ce636.js"><link rel="prefetch" href="/assets/js/73.ae696eea.js"><link rel="prefetch" href="/assets/js/75.caf8c871.js"><link rel="prefetch" href="/assets/js/76.702c7c76.js"><link rel="prefetch" href="/assets/js/77.4d49b55f.js"><link rel="prefetch" href="/assets/js/78.feebbb09.js"><link rel="prefetch" href="/assets/js/79.f45d29b6.js"><link rel="prefetch" href="/assets/js/80.9f2161de.js"><link rel="prefetch" href="/assets/js/81.820b8dd7.js"><link rel="prefetch" href="/assets/js/82.68ccd80c.js"><link rel="prefetch" href="/assets/js/83.3386f6f3.js"><link rel="prefetch" href="/assets/js/84.a781d39d.js"><link rel="prefetch" href="/assets/js/85.79b5e63f.js"><link rel="prefetch" href="/assets/js/86.6f22b386.js"><link rel="prefetch" href="/assets/js/87.e2fac3f5.js"><link rel="prefetch" href="/assets/js/88.e98f5936.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.1d2fbb22.js">
    <link rel="stylesheet" href="/assets/css/0.styles.38934ce7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">麦俊轩的博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="日常" class="dropdown-title"><span class="title">日常</span> <span class="arrow down"></span></button> <button type="button" aria-label="日常" class="mobile-dropdown-title"><span class="title">日常</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/日常/IDEA翻译插件报错更新TKK的问题/" class="nav-link">
  IDEA翻译插件报错更新TKK的问题
</a></li><li class="dropdown-item"><!----> <a href="/日常/Vue3中为什么不能使用this/" class="nav-link">
  Vue3中为什么不能使用this
</a></li><li class="dropdown-item"><!----> <a href="/日常/windows端口冲突解决/" class="nav-link">
  windows端口冲突解决
</a></li><li class="dropdown-item"><!----> <a href="/日常/解决依赖冲突/" class="nav-link">
  解决依赖冲突
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">Java</span> <span class="arrow down"></span></button> <button type="button" aria-label="Java" class="mobile-dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Java/Java基础小结/" class="nav-link">
  Java基础小结
</a></li><li class="dropdown-item"><!----> <a href="/Java/Java注解小结/" class="nav-link">
  Java注解小结
</a></li><li class="dropdown-item"><!----> <a href="/Java/Java反射小结/" class="nav-link">
  Java反射小结
</a></li><li class="dropdown-item"><!----> <a href="/Java/Java中的泛型/" class="nav-link">
  Java中的泛型
</a></li><li class="dropdown-item"><!----> <a href="/Java/谈谈Java的异常/" class="nav-link">
  谈谈Java的异常
</a></li><li class="dropdown-item"><!----> <a href="/Java/Lambda实践/" class="nav-link">
  Lambda实践
</a></li><li class="dropdown-item"><!----> <a href="/Java/Stream流实践/" class="nav-link">
  Stream流实践
</a></li><li class="dropdown-item"><!----> <a href="/Java/Java中的字符串/" class="nav-link">
  Java中的字符串
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="JUC" class="dropdown-title"><span class="title">JUC</span> <span class="arrow down"></span></button> <button type="button" aria-label="JUC" class="mobile-dropdown-title"><span class="title">JUC</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/JUC/Java中的线程池/" class="nav-link">
  Java中的线程池
</a></li><li class="dropdown-item"><!----> <a href="/JUC/Java中的并发容器/" class="nav-link">
  Java中的并发容器
</a></li><li class="dropdown-item"><!----> <a href="/JUC/谈谈ThreadLocal/" class="nav-link">
  谈谈ThreadLocal
</a></li><li class="dropdown-item"><!----> <a href="/JUC/synchronized的优化/" class="nav-link">
  synchronized的优化
</a></li><li class="dropdown-item"><!----> <a href="/JUC/CAS和原子类/" class="nav-link">
  CAS和原子类
</a></li><li class="dropdown-item"><!----> <a href="/JUC/volatile和CAS的弊端/" class="nav-link">
  volatile和CAS的弊端
</a></li><li class="dropdown-item"><!----> <a href="/JUC/CompletableFuture简单使用/" class="nav-link">
  CompletableFuture简单使用
</a></li><li class="dropdown-item"><!----> <a href="/JUC/AQS简述/" class="nav-link">
  AQS简述
</a></li><li class="dropdown-item"><!----> <a href="/JUC/JUC常用工具类/" class="nav-link">
  JUC常用工具类
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="MySQL" class="dropdown-title"><span class="title">MySQL</span> <span class="arrow down"></span></button> <button type="button" aria-label="MySQL" class="mobile-dropdown-title"><span class="title">MySQL</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/MySQL/MySQL常用语句/" class="nav-link">
  MySQL常用语句
</a></li><li class="dropdown-item"><!----> <a href="/MySQL/MySQL中的事务/" class="nav-link">
  MySQL中的事务
</a></li><li class="dropdown-item"><!----> <a href="/MySQL/一条SQL的执行过程/" class="nav-link">
  一条SQL的执行过程
</a></li><li class="dropdown-item"><!----> <a href="/MySQL/MySQL中datetime和timestamp的区别与选择/" class="nav-link">
  MySQL中datetime和timestamp的区别与选择
</a></li><li class="dropdown-item"><!----> <a href="/MySQL/普通索引和唯一索引的区别/" class="nav-link">
  普通索引和唯一索引的区别
</a></li><li class="dropdown-item"><!----> <a href="/MySQL/Explain语句/" class="nav-link">
  Explain语句
</a></li><li class="dropdown-item"><!----> <a href="/MySQL/MySQL的执行成本怎么算/" class="nav-link">
  MySQL的执行成本怎么算
</a></li><li class="dropdown-item"><!----> <a href="/MySQL/MVCC实现原理/" class="nav-link">
  MVCC实现原理
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Redis" class="dropdown-title"><span class="title">Redis</span> <span class="arrow down"></span></button> <button type="button" aria-label="Redis" class="mobile-dropdown-title"><span class="title">Redis</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Redis/Redis的安装与基本操作/" class="nav-link">
  Redis的安装与基本操作
</a></li><li class="dropdown-item"><!----> <a href="/Redis/Redis的3种特殊类型/" class="nav-link">
  Redis的3种特殊类型
</a></li><li class="dropdown-item"><!----> <a href="/Redis/Redis配置文件介绍/" class="nav-link">
  Redis配置文件介绍
</a></li><li class="dropdown-item"><!----> <a href="/Redis/Redis的Java客户端示例/" class="nav-link">
  Redis的Java客户端示例
</a></li><li class="dropdown-item"><!----> <a href="/Redis/Redis事务/" class="nav-link">
  Redis事务
</a></li><li class="dropdown-item"><!----> <a href="/Redis/RDB简介/" class="nav-link">
  RDB简介
</a></li><li class="dropdown-item"><!----> <a href="/Redis/AOF简介/" class="nav-link">
  AOF简介
</a></li><li class="dropdown-item"><!----> <a href="/Redis/主从复制及哨兵/" class="nav-link">
  主从复制及哨兵
</a></li><li class="dropdown-item"><!----> <a href="/Redis/Redis集群/" class="nav-link">
  Redis集群
</a></li><li class="dropdown-item"><!----> <a href="/Redis/使用缓存会存在哪些问题/" class="nav-link">
  使用缓存会存在哪些问题
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具" class="dropdown-title"><span class="title">工具</span> <span class="arrow down"></span></button> <button type="button" aria-label="工具" class="mobile-dropdown-title"><span class="title">工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Git
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/工具/Git/Git常用命令/" class="nav-link">
  Git常用命令
</a></li><li class="dropdown-subitem"><a href="/工具/Git/Git 提交规约/" class="nav-link">
  Git 提交规约
</a></li></ul></li><li class="dropdown-item"><h4>
          Linux
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/工具/Linux/Linux的文件结构/" class="nav-link">
  Linux的文件结构
</a></li><li class="dropdown-subitem"><a href="/工具/Linux/Linux的进程管理/" class="nav-link">
  Linux的进程管理
</a></li><li class="dropdown-subitem"><a href="/工具/Linux/Linux常用网络命令/" class="nav-link">
  Linux常用网络命令
</a></li></ul></li><li class="dropdown-item"><h4>
          Docker
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/工具/Docker/Docker常用命令/" class="nav-link">
  Docker常用命令
</a></li><li class="dropdown-subitem"><a href="/工具/Docker/DokcerCompose简单使用/" class="nav-link">
  DokcerCompose简单使用
</a></li></ul></li><li class="dropdown-item"><h4>
          Nginx
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/工具/Nginx/Nginx的安装/" class="nav-link">
  Nginx的安装
</a></li><li class="dropdown-subitem"><a href="/工具/Nginx/Nginx基础入门/" class="nav-link">
  Nginx基础入门
</a></li></ul></li><li class="dropdown-item"><h4>
          其他
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/工具/其他/Arthas使用小结/" class="nav-link">
  Arthas使用小结
</a></li><li class="dropdown-subitem"><a href="/工具/其他/基于Gitee实现Jenkins自动化部署SpringBoot项目/" class="nav-link">
  基于Gitee实现Jenkins自动化部署SpringBoot项目
</a></li><li class="dropdown-subitem"><a href="/工具/其他/基于jmeter完成压测/" class="nav-link">
  基于jmeter完成压测
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="分布式" class="dropdown-title"><span class="title">分布式</span> <span class="arrow down"></span></button> <button type="button" aria-label="分布式" class="mobile-dropdown-title"><span class="title">分布式</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/分布式/CAP和BASE理论/" class="nav-link">
  CAP和BASE理论
</a></li><li class="dropdown-item"><!----> <a href="/分布式/分布式事务的解决方案/" class="nav-link">
  分布式事务的解决方案
</a></li><li class="dropdown-item"><!----> <a href="/分布式/分布式锁的几种实现方式/" class="nav-link">
  分布式锁的几种实现方式
</a></li><li class="dropdown-item"><!----> <a href="/分布式/什么是xxl-job，它解决什么问题/" class="nav-link">
  什么是xxl-job，它解决什么问题
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架" class="dropdown-title"><span class="title">框架</span> <span class="arrow down"></span></button> <button type="button" aria-label="框架" class="mobile-dropdown-title"><span class="title">框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Spring
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/框架/Spring/Spring的常用注解/" class="nav-link">
  Spring的常用注解
</a></li><li class="dropdown-subitem"><a href="/框架/Spring/@Autowired注解详解/" class="nav-link">
  @Autowired注解详解
</a></li><li class="dropdown-subitem"><a href="/框架/Spring/SpringBean的作用域/" class="nav-link">
  SpringBean的作用域
</a></li><li class="dropdown-subitem"><a href="/框架/Spring/Spring三级缓存与循环依赖/" class="nav-link">
  Spring三级缓存与循环依赖
</a></li><li class="dropdown-subitem"><a href="/框架/Spring/JDK动态代理和CGlib代理/" class="nav-link">
  JDK动态代理和CGlib代理
</a></li></ul></li><li class="dropdown-item"><h4>
          Netty
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/框架/Netty/Netty基础概念入门小结/" class="nav-link">
  Netty基础概念入门小结
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="中间件" class="dropdown-title"><span class="title">中间件</span> <span class="arrow down"></span></button> <button type="button" aria-label="中间件" class="mobile-dropdown-title"><span class="title">中间件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          消息队列
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/中间件/RabbitMQ/RabbitMQ简单使用/" class="nav-link">
  RabbitMQ简单使用
</a></li></ul></li><li class="dropdown-item"><h4>
          Canal
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/中间件/Canal/Canal的使用/" class="nav-link">
  Canal的使用
</a></li></ul></li><li class="dropdown-item"><h4>
          Sharding-JDBC
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/中间件/Canal/Canal的使用/Sharding-JDBC的简单使用/" class="nav-link">
  Sharding-JDBC的简单使用
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="业务理解" class="dropdown-title"><span class="title">业务理解</span> <span class="arrow down"></span></button> <button type="button" aria-label="业务理解" class="mobile-dropdown-title"><span class="title">业务理解</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/业务理解/对支付系统的个人理解/" class="nav-link">
  对支付系统的个人理解
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="日常" class="dropdown-title"><span class="title">日常</span> <span class="arrow down"></span></button> <button type="button" aria-label="日常" class="mobile-dropdown-title"><span class="title">日常</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/日常/IDEA翻译插件报错更新TKK的问题/" class="nav-link">
  IDEA翻译插件报错更新TKK的问题
</a></li><li class="dropdown-item"><!----> <a href="/日常/Vue3中为什么不能使用this/" class="nav-link">
  Vue3中为什么不能使用this
</a></li><li class="dropdown-item"><!----> <a href="/日常/windows端口冲突解决/" class="nav-link">
  windows端口冲突解决
</a></li><li class="dropdown-item"><!----> <a href="/日常/解决依赖冲突/" class="nav-link">
  解决依赖冲突
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">Java</span> <span class="arrow down"></span></button> <button type="button" aria-label="Java" class="mobile-dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Java/Java基础小结/" class="nav-link">
  Java基础小结
</a></li><li class="dropdown-item"><!----> <a href="/Java/Java注解小结/" class="nav-link">
  Java注解小结
</a></li><li class="dropdown-item"><!----> <a href="/Java/Java反射小结/" class="nav-link">
  Java反射小结
</a></li><li class="dropdown-item"><!----> <a href="/Java/Java中的泛型/" class="nav-link">
  Java中的泛型
</a></li><li class="dropdown-item"><!----> <a href="/Java/谈谈Java的异常/" class="nav-link">
  谈谈Java的异常
</a></li><li class="dropdown-item"><!----> <a href="/Java/Lambda实践/" class="nav-link">
  Lambda实践
</a></li><li class="dropdown-item"><!----> <a href="/Java/Stream流实践/" class="nav-link">
  Stream流实践
</a></li><li class="dropdown-item"><!----> <a href="/Java/Java中的字符串/" class="nav-link">
  Java中的字符串
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="JUC" class="dropdown-title"><span class="title">JUC</span> <span class="arrow down"></span></button> <button type="button" aria-label="JUC" class="mobile-dropdown-title"><span class="title">JUC</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/JUC/Java中的线程池/" class="nav-link">
  Java中的线程池
</a></li><li class="dropdown-item"><!----> <a href="/JUC/Java中的并发容器/" class="nav-link">
  Java中的并发容器
</a></li><li class="dropdown-item"><!----> <a href="/JUC/谈谈ThreadLocal/" class="nav-link">
  谈谈ThreadLocal
</a></li><li class="dropdown-item"><!----> <a href="/JUC/synchronized的优化/" class="nav-link">
  synchronized的优化
</a></li><li class="dropdown-item"><!----> <a href="/JUC/CAS和原子类/" class="nav-link">
  CAS和原子类
</a></li><li class="dropdown-item"><!----> <a href="/JUC/volatile和CAS的弊端/" class="nav-link">
  volatile和CAS的弊端
</a></li><li class="dropdown-item"><!----> <a href="/JUC/CompletableFuture简单使用/" class="nav-link">
  CompletableFuture简单使用
</a></li><li class="dropdown-item"><!----> <a href="/JUC/AQS简述/" class="nav-link">
  AQS简述
</a></li><li class="dropdown-item"><!----> <a href="/JUC/JUC常用工具类/" class="nav-link">
  JUC常用工具类
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="MySQL" class="dropdown-title"><span class="title">MySQL</span> <span class="arrow down"></span></button> <button type="button" aria-label="MySQL" class="mobile-dropdown-title"><span class="title">MySQL</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/MySQL/MySQL常用语句/" class="nav-link">
  MySQL常用语句
</a></li><li class="dropdown-item"><!----> <a href="/MySQL/MySQL中的事务/" class="nav-link">
  MySQL中的事务
</a></li><li class="dropdown-item"><!----> <a href="/MySQL/一条SQL的执行过程/" class="nav-link">
  一条SQL的执行过程
</a></li><li class="dropdown-item"><!----> <a href="/MySQL/MySQL中datetime和timestamp的区别与选择/" class="nav-link">
  MySQL中datetime和timestamp的区别与选择
</a></li><li class="dropdown-item"><!----> <a href="/MySQL/普通索引和唯一索引的区别/" class="nav-link">
  普通索引和唯一索引的区别
</a></li><li class="dropdown-item"><!----> <a href="/MySQL/Explain语句/" class="nav-link">
  Explain语句
</a></li><li class="dropdown-item"><!----> <a href="/MySQL/MySQL的执行成本怎么算/" class="nav-link">
  MySQL的执行成本怎么算
</a></li><li class="dropdown-item"><!----> <a href="/MySQL/MVCC实现原理/" class="nav-link">
  MVCC实现原理
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Redis" class="dropdown-title"><span class="title">Redis</span> <span class="arrow down"></span></button> <button type="button" aria-label="Redis" class="mobile-dropdown-title"><span class="title">Redis</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Redis/Redis的安装与基本操作/" class="nav-link">
  Redis的安装与基本操作
</a></li><li class="dropdown-item"><!----> <a href="/Redis/Redis的3种特殊类型/" class="nav-link">
  Redis的3种特殊类型
</a></li><li class="dropdown-item"><!----> <a href="/Redis/Redis配置文件介绍/" class="nav-link">
  Redis配置文件介绍
</a></li><li class="dropdown-item"><!----> <a href="/Redis/Redis的Java客户端示例/" class="nav-link">
  Redis的Java客户端示例
</a></li><li class="dropdown-item"><!----> <a href="/Redis/Redis事务/" class="nav-link">
  Redis事务
</a></li><li class="dropdown-item"><!----> <a href="/Redis/RDB简介/" class="nav-link">
  RDB简介
</a></li><li class="dropdown-item"><!----> <a href="/Redis/AOF简介/" class="nav-link">
  AOF简介
</a></li><li class="dropdown-item"><!----> <a href="/Redis/主从复制及哨兵/" class="nav-link">
  主从复制及哨兵
</a></li><li class="dropdown-item"><!----> <a href="/Redis/Redis集群/" class="nav-link">
  Redis集群
</a></li><li class="dropdown-item"><!----> <a href="/Redis/使用缓存会存在哪些问题/" class="nav-link">
  使用缓存会存在哪些问题
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具" class="dropdown-title"><span class="title">工具</span> <span class="arrow down"></span></button> <button type="button" aria-label="工具" class="mobile-dropdown-title"><span class="title">工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Git
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/工具/Git/Git常用命令/" class="nav-link">
  Git常用命令
</a></li><li class="dropdown-subitem"><a href="/工具/Git/Git 提交规约/" class="nav-link">
  Git 提交规约
</a></li></ul></li><li class="dropdown-item"><h4>
          Linux
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/工具/Linux/Linux的文件结构/" class="nav-link">
  Linux的文件结构
</a></li><li class="dropdown-subitem"><a href="/工具/Linux/Linux的进程管理/" class="nav-link">
  Linux的进程管理
</a></li><li class="dropdown-subitem"><a href="/工具/Linux/Linux常用网络命令/" class="nav-link">
  Linux常用网络命令
</a></li></ul></li><li class="dropdown-item"><h4>
          Docker
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/工具/Docker/Docker常用命令/" class="nav-link">
  Docker常用命令
</a></li><li class="dropdown-subitem"><a href="/工具/Docker/DokcerCompose简单使用/" class="nav-link">
  DokcerCompose简单使用
</a></li></ul></li><li class="dropdown-item"><h4>
          Nginx
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/工具/Nginx/Nginx的安装/" class="nav-link">
  Nginx的安装
</a></li><li class="dropdown-subitem"><a href="/工具/Nginx/Nginx基础入门/" class="nav-link">
  Nginx基础入门
</a></li></ul></li><li class="dropdown-item"><h4>
          其他
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/工具/其他/Arthas使用小结/" class="nav-link">
  Arthas使用小结
</a></li><li class="dropdown-subitem"><a href="/工具/其他/基于Gitee实现Jenkins自动化部署SpringBoot项目/" class="nav-link">
  基于Gitee实现Jenkins自动化部署SpringBoot项目
</a></li><li class="dropdown-subitem"><a href="/工具/其他/基于jmeter完成压测/" class="nav-link">
  基于jmeter完成压测
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="分布式" class="dropdown-title"><span class="title">分布式</span> <span class="arrow down"></span></button> <button type="button" aria-label="分布式" class="mobile-dropdown-title"><span class="title">分布式</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/分布式/CAP和BASE理论/" class="nav-link">
  CAP和BASE理论
</a></li><li class="dropdown-item"><!----> <a href="/分布式/分布式事务的解决方案/" class="nav-link">
  分布式事务的解决方案
</a></li><li class="dropdown-item"><!----> <a href="/分布式/分布式锁的几种实现方式/" class="nav-link">
  分布式锁的几种实现方式
</a></li><li class="dropdown-item"><!----> <a href="/分布式/什么是xxl-job，它解决什么问题/" class="nav-link">
  什么是xxl-job，它解决什么问题
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架" class="dropdown-title"><span class="title">框架</span> <span class="arrow down"></span></button> <button type="button" aria-label="框架" class="mobile-dropdown-title"><span class="title">框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Spring
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/框架/Spring/Spring的常用注解/" class="nav-link">
  Spring的常用注解
</a></li><li class="dropdown-subitem"><a href="/框架/Spring/@Autowired注解详解/" class="nav-link">
  @Autowired注解详解
</a></li><li class="dropdown-subitem"><a href="/框架/Spring/SpringBean的作用域/" class="nav-link">
  SpringBean的作用域
</a></li><li class="dropdown-subitem"><a href="/框架/Spring/Spring三级缓存与循环依赖/" class="nav-link">
  Spring三级缓存与循环依赖
</a></li><li class="dropdown-subitem"><a href="/框架/Spring/JDK动态代理和CGlib代理/" class="nav-link">
  JDK动态代理和CGlib代理
</a></li></ul></li><li class="dropdown-item"><h4>
          Netty
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/框架/Netty/Netty基础概念入门小结/" class="nav-link">
  Netty基础概念入门小结
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="中间件" class="dropdown-title"><span class="title">中间件</span> <span class="arrow down"></span></button> <button type="button" aria-label="中间件" class="mobile-dropdown-title"><span class="title">中间件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          消息队列
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/中间件/RabbitMQ/RabbitMQ简单使用/" class="nav-link">
  RabbitMQ简单使用
</a></li></ul></li><li class="dropdown-item"><h4>
          Canal
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/中间件/Canal/Canal的使用/" class="nav-link">
  Canal的使用
</a></li></ul></li><li class="dropdown-item"><h4>
          Sharding-JDBC
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/中间件/Canal/Canal的使用/Sharding-JDBC的简单使用/" class="nav-link">
  Sharding-JDBC的简单使用
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="业务理解" class="dropdown-title"><span class="title">业务理解</span> <span class="arrow down"></span></button> <button type="button" aria-label="业务理解" class="mobile-dropdown-title"><span class="title">业务理解</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/业务理解/对支付系统的个人理解/" class="nav-link">
  对支付系统的个人理解
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>nginx基础入门</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/%E5%B7%A5%E5%85%B7/Nginx/Nginx%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8.html#nginx常用命令" class="sidebar-link">nginx常用命令</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/%E5%B7%A5%E5%85%B7/Nginx/Nginx%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8.html#nginx配置文件简介" class="sidebar-link">nginx配置文件简介</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/%E5%B7%A5%E5%85%B7/Nginx/Nginx%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8.html#nginx反向代理" class="sidebar-link">nginx反向代理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/%E5%B7%A5%E5%85%B7/Nginx/Nginx%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8.html#简介" class="sidebar-link">简介</a></li><li class="sidebar-sub-header"><a href="/%E5%B7%A5%E5%85%B7/Nginx/Nginx%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8.html#反向代理示例1" class="sidebar-link">反向代理示例1</a></li><li class="sidebar-sub-header"><a href="/%E5%B7%A5%E5%85%B7/Nginx/Nginx%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8.html#反向代理示例2" class="sidebar-link">反向代理示例2</a></li></ul></li><li><a href="/%E5%B7%A5%E5%85%B7/Nginx/Nginx%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8.html#负载均衡" class="sidebar-link">负载均衡</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/%E5%B7%A5%E5%85%B7/Nginx/Nginx%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8.html#需求-2" class="sidebar-link">需求</a></li><li class="sidebar-sub-header"><a href="/%E5%B7%A5%E5%85%B7/Nginx/Nginx%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8.html#步骤-2" class="sidebar-link">步骤</a></li><li class="sidebar-sub-header"><a href="/%E5%B7%A5%E5%85%B7/Nginx/Nginx%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8.html#nginx-分配服务器策略" class="sidebar-link">nginx 分配服务器策略</a></li></ul></li><li><a href="/%E5%B7%A5%E5%85%B7/Nginx/Nginx%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8.html#动静分离" class="sidebar-link">动静分离</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/%E5%B7%A5%E5%85%B7/Nginx/Nginx%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8.html#模拟实验" class="sidebar-link">模拟实验</a></li><li class="sidebar-sub-header"><a href="/%E5%B7%A5%E5%85%B7/Nginx/Nginx%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8.html#配置步骤" class="sidebar-link">配置步骤</a></li></ul></li><li><a href="/%E5%B7%A5%E5%85%B7/Nginx/Nginx%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8.html#高可用配置" class="sidebar-link">高可用配置</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/%E5%B7%A5%E5%85%B7/Nginx/Nginx%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8.html#介绍" class="sidebar-link">介绍</a></li><li class="sidebar-sub-header"><a href="/%E5%B7%A5%E5%85%B7/Nginx/Nginx%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8.html#配置" class="sidebar-link">配置</a></li></ul></li><li><a href="/%E5%B7%A5%E5%85%B7/Nginx/Nginx%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8.html#nginx原理解析" class="sidebar-link">nginx原理解析</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/%E5%B7%A5%E5%85%B7/Nginx/Nginx%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8.html#杀死nginx所有进程" class="sidebar-link">杀死nginx所有进程</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/%E5%B7%A5%E5%85%B7/Nginx/Nginx%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8.html#nginx其他问题" class="sidebar-link">nginx其他问题</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/%E5%B7%A5%E5%85%B7/Nginx/Nginx%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8.html#常见问题" class="sidebar-link">常见问题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/%E5%B7%A5%E5%85%B7/Nginx/Nginx%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8.html#nginx配置不生效" class="sidebar-link">nginx配置不生效</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="nginx基础入门"><a href="#nginx基础入门" class="header-anchor">#</a> nginx基础入门</h1> <h2 id="nginx常用命令"><a href="#nginx常用命令" class="header-anchor">#</a> nginx常用命令</h2> <div class="language-java line-numbers-mode"><pre class="language-java"><code># 进入nginx目录
cd <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>sbin
# 查看nginx版本号
<span class="token punctuation">.</span>/nginx <span class="token operator">-</span>v

# 启动nginx
<span class="token punctuation">.</span>/nginx

# 停止nginx
<span class="token punctuation">.</span>/nginx <span class="token operator">-</span>s stop

# 重新加载nginx
<span class="token punctuation">.</span>/nginx <span class="token operator">-</span>s reload
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="nginx配置文件简介"><a href="#nginx配置文件简介" class="header-anchor">#</a> nginx配置文件简介</h2> <div class="language-java line-numbers-mode"><pre class="language-java"><code># 查看tomcat配置
cat <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>conf<span class="token operator">/</span>nginx<span class="token punctuation">.</span>conf
全局配置

#user nobody；                         #运行用户

<span class="token class-name">Worker_processes</span> <span class="token number">1</span> <span class="token punctuation">;</span>               #工作进程数量

#error_log  log<span class="token operator">/</span>error<span class="token punctuation">.</span>log           #错误日志文件的位置

#pid     log<span class="token operator">/</span>nginx<span class="token punctuation">.</span>pid                 #<span class="token constant">PID</span>文件的位置



<span class="token class-name">I</span><span class="token operator">/</span><span class="token class-name">O</span>事件配置

events<span class="token punctuation">{</span>

use  epoll<span class="token punctuation">;</span>                              #使用epoll模型

worker_connections <span class="token number">4096</span>     #每进程处理<span class="token number">4096</span>个连接

<span class="token punctuation">}</span>

<span class="token constant">HTTP</span>配置

http <span class="token punctuation">{</span>

<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

include mine<span class="token punctuation">.</span>types<span class="token punctuation">;</span>                                              #nginx支持的媒体类型库文件

#include  benet<span class="token operator">/</span>www<span class="token punctuation">.</span>conf     #配置多个虚拟机主机，把server<span class="token punctuation">{</span><span class="token punctuation">}</span>内的内容复制到外面新建的www<span class="token punctuation">.</span>conf后包含进去     

default_type        application<span class="token operator">/</span>octet<span class="token operator">-</span>stranm<span class="token punctuation">;</span> #默认的媒体类型

access_log   log<span class="token operator">/</span>access<span class="token punctuation">.</span>log     main<span class="token punctuation">;</span>   #访问日志位置

sendfile       on <span class="token punctuation">;</span>    #开启高效传输模式<span class="token punctuation">(</span>支持文件发送下载<span class="token punctuation">)</span>

keepalive_timeout <span class="token number">65</span><span class="token punctuation">;</span>     #连接保持超时



server <span class="token punctuation">{</span>                                                               #可配置对三个基于域名的虚拟主机

listen    <span class="token number">80</span><span class="token punctuation">;</span>       #web服务的监听配置

server_name   www<span class="token punctuation">.</span>benet<span class="token punctuation">.</span>com   #网站名称（<span class="token constant">FQDN</span>），别名就是在后面再添加网址

charset  utf<span class="token operator">-</span><span class="token number">8</span>               #网页的默认字符集

location <span class="token operator">/</span> <span class="token punctuation">{</span>

      root   html<span class="token punctuation">;</span>           #网站根目录的位置

     error_page    <span class="token number">500</span> <span class="token number">502</span> <span class="token number">503</span> <span class="token number">504</span> <span class="token operator">/</span><span class="token number">50</span>x<span class="token punctuation">.</span>html<span class="token punctuation">;</span>    #出现对应的http状态码时，使<span class="token number">50</span>x<span class="token punctuation">.</span>html回应客户

    location <span class="token operator">=</span> <span class="token operator">/</span><span class="token number">50</span>x<span class="token punctuation">.</span>html <span class="token punctuation">{</span>

            root     html<span class="token punctuation">;</span>        #指定对应的站点目录为html

<span class="token punctuation">}</span>

         index index<span class="token punctuation">.</span>html index<span class="token punctuation">.</span>php      #默认首页    

         <span class="token punctuation">}</span>

<span class="token punctuation">}</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br></div></div><h2 id="nginx反向代理"><a href="#nginx反向代理" class="header-anchor">#</a> nginx反向代理</h2> <h3 id="简介"><a href="#简介" class="header-anchor">#</a> 简介</h3> <p>网站建立后，用户希望只需通过一个url即可访问网站。但是网站所使的服务器可能远不止一台(考虑到用户的访问量在多台服务器上配置tomcat)，所以如何访问通过一个url且还能保证服务器负载均衡的情况下完成用户访问我们的网站呢？nginx的反向代理就是最好的解决方案。 如下图所示，用户通过<code>www.xxx.com</code>交由dns解析到而访问到nginx，此时nginx就是一个反向代理的角色，nginx这时候就会工具服务器详情动态的决定访问哪台服务器。</p> <p><img src="https://cdn.jsdelivr.net/gh/mai-junxuan/Cloud-image/image/202209030024451.png" alt="image-20220903002420204"></p> <h3 id="反向代理示例1"><a href="#反向代理示例1" class="header-anchor">#</a> 反向代理示例1</h3> <h4 id="需求描述"><a href="#需求描述" class="header-anchor">#</a> 需求描述</h4> <p>打开浏览器，在浏览器地址栏输入地址 <a href="http://www.test.com/" target="_blank" rel="noopener noreferrer">www.test.com<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ，跳转到 linux系统 tomcat 主页中</p> <h4 id="前置步骤"><a href="#前置步骤" class="header-anchor">#</a> 前置步骤</h4> <p>安装tomcat服务器</p> <p>设置域名重定向</p> <p>由于本次实验需要通过域名访问nginx然后通过nginx请求tomcat主页并返回，所以为避免dns无法解析我们模拟的域名地址，可以在本机Windows下配置域名解析，具体步骤如下</p> <ol><li>进入如下目录编辑hosts文件</li></ol> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">C</span><span class="token operator">:</span>\<span class="token class-name">Windows</span>\<span class="token class-name">System32</span>\drivers\etc
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol><li>编辑该配置文件，内容如下，这里的ip地址是和本机桥接的虚拟机ip地址</li> <li><img src="https://cdn.jsdelivr.net/gh/mai-junxuan/Cloud-image/image/202209030024240.png" alt="image-20220903002442301"></li></ol> <h4 id="nginx配置步骤"><a href="#nginx配置步骤" class="header-anchor">#</a> nginx配置步骤</h4> <p>配置nginx请求转发 如下图所示，编辑<code>/usr/local/nginx/conf/nginx.conf</code>将内容改为如下所示</p> <p><img src="https://cdn.jsdelivr.net/gh/mai-junxuan/Cloud-image/image/202209030025806.png" alt="image-20220903002502384"></p> <p>重启nginx</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>#进入sbin目录输入
<span class="token punctuation">.</span>/nginx <span class="token operator">-</span>s reload
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>查看结果 <img src="https://cdn.jsdelivr.net/gh/mai-junxuan/Cloud-image/image/202209030025517.png" alt="在这里插入图片描述"></p> <h3 id="反向代理示例2"><a href="#反向代理示例2" class="header-anchor">#</a> 反向代理示例2</h3> <h4 id="需求"><a href="#需求" class="header-anchor">#</a> 需求</h4> <p>使用 nginx 反向代理，根据访问的路径跳转到不同端口的服务中，nginx 监听端口为 9001。即访问<code>192.168.1.29:9001/test1/index.html</code>和<code>192.168.1.29:9001/test2/index.html</code>访问结果是不同的</p> <p><img src="https://cdn.jsdelivr.net/gh/mai-junxuan/Cloud-image/image/202209030025867.png" alt="在这里插入图片描述"></p> <h4 id="步骤"><a href="#步骤" class="header-anchor">#</a> 步骤</h4> <ol><li>增加一台tomcat，如之前所示，注意修改相关端口与之区分，修改的端口如下所示：</li></ol> <p><img src="https://cdn.jsdelivr.net/gh/mai-junxuan/Cloud-image/image/202209030026552.png" alt="image-20220903002548213"></p> <p><img src="https://cdn.jsdelivr.net/gh/mai-junxuan/Cloud-image/image/202209030025267.png" alt="在这里插入图片描述">)<img src="https://cdn.jsdelivr.net/gh/mai-junxuan/Cloud-image/image/202209030026920.png" alt="在这里插入图片描述"></p> <ol><li>启动tomcat</li> <li>为两个tomcat配置不同的页面,即在分别在两台tomcat服务器下<code>webapp</code>下,第一台tomcat参见test1目录并添加index网页，第二台tomcat服务器参见test2目录添加index网页。</li> <li>测试两台tomcat</li></ol> <p><img src="https://cdn.jsdelivr.net/gh/mai-junxuan/Cloud-image/image/202209030026407.png" alt="image-20220903002636221"></p> <p><img src="https://cdn.jsdelivr.net/gh/mai-junxuan/Cloud-image/image/202209030026433.png" alt="image-20220903002653947"></p> <ol><li>进行反向代理配置 进入nginx.conf进行如下配置</li></ol> <div class="language-java line-numbers-mode"><pre class="language-java"><code>  server <span class="token punctuation">{</span>
        listen       <span class="token number">9001</span><span class="token punctuation">;</span>
        server_name  <span class="token number">192.168</span><span class="token number">.1</span><span class="token number">.29</span><span class="token punctuation">;</span>

        location <span class="token operator">~</span> <span class="token operator">/</span>test1<span class="token operator">/</span> <span class="token punctuation">{</span>
          proxy_pass   http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">8080</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span>

    location <span class="token operator">~</span> <span class="token operator">/</span>test2<span class="token operator">/</span> <span class="token punctuation">{</span>
          proxy_pass   http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">8081</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><ol start="2"><li>开放9001端口</li></ol> <div class="language-java line-numbers-mode"><pre class="language-java"><code> firewall<span class="token operator">-</span>cmd <span class="token operator">--</span>zone<span class="token operator">=</span><span class="token keyword">public</span> <span class="token operator">--</span>add<span class="token operator">-</span>port<span class="token operator">=</span><span class="token number">9001</span><span class="token operator">/</span>tcp <span class="token operator">--</span>permanent
systemctl stop firewalld<span class="token punctuation">.</span>service
systemctl start firewalld<span class="token punctuation">.</span>service

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ol start="3"><li>测试</li></ol> <p><img src="https://cdn.jsdelivr.net/gh/mai-junxuan/Cloud-image/image/202209030028159.png" alt="image-20220903002810057"></p> <p><img src="https://cdn.jsdelivr.net/gh/mai-junxuan/Cloud-image/image/202209030028558.png" alt="image-20220903002825015"></p> <h2 id="负载均衡"><a href="#负载均衡" class="header-anchor">#</a> 负载均衡</h2> <h3 id="需求-2"><a href="#需求-2" class="header-anchor">#</a> 需求</h3> <p>浏览器地址栏输入地址 <code>http://192.168.1.29/study/index.html</code> 请求web页面，nginx会将多个http请求分配到8080或者8081服务器中。</p> <h3 id="步骤-2"><a href="#步骤-2" class="header-anchor">#</a> 步骤</h3> <ol><li><p>准备两台tomcat服务器，并在webapp目录下创建study文件夹，并在文件夹中都创建一个index.html内容随意</p></li> <li><p>开启tomcat测试是否可达</p> <p><img src="C:%5CUsers%5CMJX%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20220903002900385.png" alt="image-20220903002900385"></p> <p><img src="https://cdn.jsdelivr.net/gh/mai-junxuan/Cloud-image/image/202209030029388.png" alt="image-20220903002909832"></p></li> <li><p>配置nginx负载均衡配置 如下所示，<code>upstream</code> 即负载服务器，下文将<code>upstream</code>起名为myserver，然后在server中配置负载服务器名myserver即可完成负载均衡配置。</p></li></ol> <div class="language-java line-numbers-mode"><pre class="language-java"><code> upstream myserver<span class="token punctuation">{</span>
        server <span class="token number">192.168</span><span class="token number">.1</span><span class="token number">.29</span><span class="token operator">:</span><span class="token number">8080</span><span class="token punctuation">;</span>
        server <span class="token number">192.168</span><span class="token number">.1</span><span class="token number">.29</span><span class="token operator">:</span><span class="token number">8081</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

    server <span class="token punctuation">{</span>
        listen       <span class="token number">80</span><span class="token punctuation">;</span>
        server_name  <span class="token number">192.168</span><span class="token number">.1</span><span class="token number">.29</span><span class="token punctuation">;</span>

        #charset koi8<span class="token operator">-</span>r<span class="token punctuation">;</span>

        #access_log  logs<span class="token operator">/</span>host<span class="token punctuation">.</span>access<span class="token punctuation">.</span>log  main<span class="token punctuation">;</span>

        location <span class="token operator">/</span> <span class="token punctuation">{</span>
            root   html<span class="token punctuation">;</span>
            proxy_pass http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>myserver<span class="token punctuation">;</span>
            index  index<span class="token punctuation">.</span>html index<span class="token punctuation">.</span>htm<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><ol><li><p>测试</p> <p><img src="https://cdn.jsdelivr.net/gh/mai-junxuan/Cloud-image/image/202209030029013.png" alt="image-20220903001416365"></p> <h3 id="nginx-分配服务器策略"><a href="#nginx-分配服务器策略" class="header-anchor">#</a> nginx 分配服务器策略</h3> <h4 id="第一种-轮询-默认"><a href="#第一种-轮询-默认" class="header-anchor">#</a> 第一种 轮询（默认）</h4> <p>每个请求按时间顺序逐一分配到不同的后端服务器，如果后端服务器 down 掉,则自动剔除。</p> <h4 id="第二种-weight"><a href="#第二种-weight" class="header-anchor">#</a> 第二种 weight</h4> <p>weight 代表权重默认为 1, 权重越高被分配的客户端越多</p> <h4 id="第三种-ip-hash"><a href="#第三种-ip-hash" class="header-anchor">#</a> 第三种 ip_hash</h4> <p>每个请求按访问 ip 的 的 hash 结果分配，这样每个访客固定访问一个后端服务器</p> <h4 id="第四种-fair-第三方"><a href="#第四种-fair-第三方" class="header-anchor">#</a> 第四种 fair （第三方）</h4> <p>按后端服务器的响应时间来分配请求，响应时间短的优先分配。</p></li></ol> <h2 id="动静分离"><a href="#动静分离" class="header-anchor">#</a> 动静分离</h2> <p>我们都知道请求一个web页面过程中，需要加载动态数据或者静态数据。动态数据变化多端，而静态数据基本不变。动静分离以后我们可以对静态文件进行缓存、或者压缩提高网站性能。</p> <h3 id="模拟实验"><a href="#模拟实验" class="header-anchor">#</a> 模拟实验</h3> <p>为了模仿动态文件和静态文件的场景，笔者在/data目录下创建www作为动态文件夹，img为静态文件夹。通过同一个http请求+文件路径模仿动态文件和静态文件的访问过程。</p> <h3 id="配置步骤"><a href="#配置步骤" class="header-anchor">#</a> 配置步骤</h3> <ol><li>data文件夹下创建动态文件和静态文件目录并添加文件</li> <li>nginx添加如下配置</li></ol> <p><img src="https://cdn.jsdelivr.net/gh/mai-junxuan/Cloud-image/image/202209030029668.png" alt="image-20220903002941796"></p> <ol start="3"><li><p>测试</p> <p><img src="https://cdn.jsdelivr.net/gh/mai-junxuan/Cloud-image/image/202209030030900.png" alt="image-20220903003003145"></p></li></ol> <p><img src="https://cdn.jsdelivr.net/gh/mai-junxuan/Cloud-image/image/202209030030572.png" alt="image-20220903003017327"></p> <h2 id="高可用配置"><a href="#高可用配置" class="header-anchor">#</a> 高可用配置</h2> <h3 id="介绍"><a href="#介绍" class="header-anchor">#</a> 介绍</h3> <p>如下图，若只有一台nginx时，常规情况下发起http请求由nginx代理是正常的。当这台nginx服务器出现故障宕机了怎么办呢？ <img src="https://cdn.jsdelivr.net/gh/mai-junxuan/Cloud-image/image/202209030030100.png" alt="在这里插入图片描述"> 面对这种情况，我们预想的最好解决方案就是增加一台nginx服务器作为备用代理服务器，从而做到高可用配置。 如下图所示，用户使用192.168.1.50发起请求，若master主服务器正常则会交由主服务器代理http请求，若主服务器出现故障则由备用服务器进行http代理请求</p> <p><img src="https://cdn.jsdelivr.net/gh/mai-junxuan/Cloud-image/image/202209030030539.png" alt="在这里插入图片描述"></p> <h3 id="配置"><a href="#配置" class="header-anchor">#</a> 配置</h3> <ol><li>增加一台虚拟机安装nginx服务器</li> <li>两台虚拟机都安装keepalived</li></ol> <div class="language-java line-numbers-mode"><pre class="language-java"><code>yum install keepalived –y

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ol><li>配置keepalived</li></ol> <div class="language-java line-numbers-mode"><pre class="language-java"><code>配置keepalived检查主机存货状态脚本
vim <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>src<span class="token operator">/</span>nginx_check<span class="token punctuation">.</span>sh 

# 粘贴下方内容
#<span class="token operator">!</span><span class="token operator">/</span>bin<span class="token operator">/</span>bash
<span class="token class-name">A</span><span class="token operator">=</span>`ps <span class="token operator">-</span><span class="token class-name">C</span> nginx –no<span class="token operator">-</span>header <span class="token operator">|</span>wc <span class="token operator">-</span>l`
<span class="token keyword">if</span> <span class="token punctuation">[</span> $<span class="token class-name">A</span> <span class="token operator">-</span>eq <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>then
    <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>sbin<span class="token operator">/</span>nginx
    sleep <span class="token number">2</span>
    <span class="token keyword">if</span> <span class="token punctuation">[</span> `ps <span class="token operator">-</span><span class="token class-name">C</span> nginx <span class="token operator">--</span>no<span class="token operator">-</span>header <span class="token operator">|</span>wc <span class="token operator">-</span>l` <span class="token operator">-</span>eq <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>then
        killall keepalived
    fi
fi
vim cd <span class="token operator">/</span>etc<span class="token operator">/</span>keepalived<span class="token operator">/</span>keepalived<span class="token punctuation">.</span>conf #编辑keepalived的配置文件

# 直接将内容覆盖成如下配置 配置详情可见注释
global_defs <span class="token punctuation">{</span>
notification_email <span class="token punctuation">{</span>
acassen<span class="token annotation punctuation">@firewall.loc</span>
failover<span class="token annotation punctuation">@firewall.loc</span>
sysadmin<span class="token annotation punctuation">@firewall.loc</span>
<span class="token punctuation">}</span>
notification_email_from <span class="token class-name">Alexandre<span class="token punctuation">.</span>Cassen</span><span class="token annotation punctuation">@firewall.loc</span>
smtp_server <span class="token number">192.168</span><span class="token number">.1</span><span class="token number">.150</span> #本机ip地址
smtp_connect_timeout <span class="token number">30</span>
router_id <span class="token constant">LVS_DEVEL</span> # 本机设备名称，可使用命令 vim <span class="token operator">/</span>etc<span class="token operator">/</span>hosts 添加一行 <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span> <span class="token constant">LVS_DEVEL</span> 完成主机id配置
<span class="token punctuation">}</span>

# 下方为vrrp协议具体内容可参见百度
vrrp_script chk_http_port <span class="token punctuation">{</span>
script <span class="token string">&quot;/usr/local/src/nginx_check.sh&quot;</span> # 检查当前服务器是否存货的脚本路径
interval <span class="token number">2</span> #（检测脚本执行的间隔） 
weight <span class="token number">2</span>
<span class="token punctuation">}</span>
vrrp_instance <span class="token constant">VI_1</span> <span class="token punctuation">{</span>
state <span class="token constant">MASTER</span> # 备份服务器上将 <span class="token constant">MASTER</span> 改为 <span class="token constant">BACKUP</span>
<span class="token keyword">interface</span> ens33 <span class="token comment">//网卡</span>
virtual_router_id <span class="token number">51</span> # 主、备机的 virtual_router_id 必须相同
priority <span class="token number">100</span>
advert_int <span class="token number">1</span>
authentication <span class="token punctuation">{</span>
auth_type <span class="token constant">PASS</span>
auth_pass <span class="token number">1111</span>
<span class="token punctuation">}</span>
virtual_ipaddress <span class="token punctuation">{</span>
<span class="token number">192.168</span><span class="token number">.1</span><span class="token number">.50</span> <span class="token comment">// VRRP H 虚拟地址</span>
<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br></div></div><ol><li>开启nginx</li> <li>开启keepalive</li></ol> <div class="language-java line-numbers-mode"><pre class="language-java"><code>systemctl start keepalived<span class="token punctuation">.</span>service
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol><li>测试 使用192.168.1.50访问，若可以访问将master主机keepalived以及nginx关闭，再进行访问，关闭命令如下</li></ol> <div class="language-java line-numbers-mode"><pre class="language-java"><code>systemctl stop keepalived<span class="token punctuation">.</span>service
<span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>sbin<span class="token operator">/</span>nginx <span class="token operator">-</span>s stop

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/mai-junxuan/Cloud-image/image/202209030030238.png" alt="在这里插入图片描述"></p> <h2 id="nginx原理解析"><a href="#nginx原理解析" class="header-anchor">#</a> nginx原理解析</h2> <p>我们可以使用以下命令可以看到nginx的进程数</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>ps <span class="token operator">-</span>ef <span class="token operator">|</span>grep nginx

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/mai-junxuan/Cloud-image/image/202209030031746.png" alt="image-20220903003104104"></p> <p>可以看出nginx占用了两个进程，一个是master，一个是worker，在我们发起请求到nginx时，nginx的master会收到该请求，并将请求发送给每个worker，所有worker会参与争抢。某个worker得到该请求后，若该请求是个代理请求，worker则会转发该请求到目标服务器。如下图所示： <img src="https://cdn.jsdelivr.net/gh/mai-junxuan/Cloud-image/image/202209030031942.png" alt="在这里插入图片描述"> 那么问题来了，一个master搭配多个worker的好处有哪些呢？</p> <ol><li>热部署时，刷新配置不影响正在工作的worker。比如，我们当前这台nginx正在工作。某个worker正在担任某个服务器代理。此时，我们在nginx配置中添加一个新的代理工作。使用 <code>./nginx -s reload</code>完成nginx重新加载，这时候就会又新的worker争抢这份工作。而之前已有工作的worker却不会收到影响。</li> <li>每个worker是独立的进程。当某个worker出现问题时，其他worker不会收到影响。</li></ol> <p>由此我们又会问，那么设置几个worker数为宜呢？ 与cpu数相等即可。比如八核就设置八个。</p> <h2 id="杀死nginx所有进程"><a href="#杀死nginx所有进程" class="header-anchor">#</a> 杀死nginx所有进程</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>kill -9 $(ps aux | grep 'nginx' | grep -v grep | tr -s ' '| cut -d ' ' -f 2)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="nginx其他问题"><a href="#nginx其他问题" class="header-anchor">#</a> nginx其他问题</h2> <p>(1) 发送一个请求时，master会占用worker几个连接数。</p> <p>当只是请求静态资源时，只有<code>请求结果，返回结果</code>这样一趟也就是两个请求。若作为代理，则是<code>master-&gt;worker-&gt;目标服务器</code>+<code>目标服务器-&gt;worker-&gt;master</code>计算箭头数则是4个请求。</p> <p>(2)假设nginx有一个master，和四个worker ，每个worker支持最大连接数为1024，支持的最大并发数为多少？ 普通静态访问为：<code>4*1024/2</code>(除2原因是因为一个静态请求有一趟往返，有一半的连接数处理返回结果了) 反向代理则是 <code>4*1024/4</code>(与上同理)</p> <h2 id="常见问题"><a href="#常见问题" class="header-anchor">#</a> 常见问题</h2> <h3 id="nginx配置不生效"><a href="#nginx配置不生效" class="header-anchor">#</a> nginx配置不生效</h3> <h4 id="问题简述"><a href="#问题简述" class="header-anchor">#</a> 问题简述</h4> <p>笔者在这段时间进行nginx配置时，进行正确的配置却发现配置没有生效，不断查看配置和reload没有发现问题所在。</p> <h4 id="解决方案"><a href="#解决方案" class="header-anchor">#</a> 解决方案</h4> <p>经过大佬排查很可能是nginx配置没有生效，将nginx所有进程杀死并重启nginx后配置就生效了，所以面对这类这类问题，在一切配置和部署方式都是正确的情况下，我们排查方向要从是否正确运行的方向进行思考。</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.66e71283.js" defer></script><script src="/assets/js/2.2d1cac8d.js" defer></script><script src="/assets/js/1.ab819bd9.js" defer></script><script src="/assets/js/74.f547417c.js" defer></script>
  </body>
</html>
